{
  "Name": "TestCaseCE",
  "CreationDate": "2024-5-30",
  "Commands": [
    {
      "Command": "store",
      "Target": "fast",
      "Value": "!replayspeed",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "true",
      "Value": "!errorIgnore",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "${!Runtime}",
      "Value": "StartTime",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "**Start of TestCaseMX**",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "Inside subroutine: Status = ${!csvReadStatus}, Line = ${!csvReadLineNumber}",
      "Value": "green",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "**Open URL**",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "open",
      "Target": "${!COL11}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "Passed",
      "Value": "TestResult",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "var today = new Date();\nvar date = today.getFullYear() + \"-\" + (today.getMonth() + 1) + \"-\" + today.getDate()\nreturn date;",
      "Value": "DateToday",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "var today = new Date();\nvar time = today.getFullYear() + \"-\" + (today.getMonth() + 1) + \"-\" + today.getDate() + \" \" + today.getHours() + \":\" + today.getMinutes() + \":\" + today.getSeconds();\nreturn time;",
      "Value": "DateTimeNow",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "${DateTimeNow}",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "true",
      "Value": "!statusOK",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "**Store Variables**",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "-",
      "Value": "CaseID",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "${!COL2}",
      "Value": "CaseID",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "${CaseID}",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "${!COL7}",
      "Value": "ProductName",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "${!COL10}",
      "Value": "SKU",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "return ${SKU}.replace(/\\//g,\"\");",
      "Value": "SKUwithoutSlash",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "${!COL9}",
      "Value": "BcBuy",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "${!COL18}",
      "Value": "TradeUp",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "return Number(${!COL20}.replace(/[^0-9.-]+/g,\"\"));",
      "Value": "ExpectedTradeUpDiscount",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "${!COL28}",
      "Value": "PromoCode1",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "${!COL29}",
      "Value": "PromoCode2",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "${!COL30}",
      "Value": "PromoCode3",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "return Number(${!COL17}.replace(/[^0-9.-]+/g,\"\"));",
      "Value": "ExpectedSKUPrice",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "return Number(${!COL32}.replace(/[^0-9.-]+/g,\"\"));",
      "Value": "ExpectedSKUPriceCart",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "executeScript // return arry=[\"Z-EB-P3400XUEGWW\", \"Z-EP-T2510XBEGGB\", \"Z-SM-X210NZAATGY\"]",
      "Value": "ExpectedPremiumArray",
      "Description": ""
    },
    {
      "Command": "if_v2",
      "Target": "${!COL44}==\"\"",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "return [\"\"]",
      "Value": "ExpectedPremiumArray",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "return 0",
      "Value": "ExpectedPremiumCount",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "return 0",
      "Value": "ExpectedPremiumQty",
      "Description": ""
    },
    {
      "Command": "else",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "return ${!COL44}.split(',')",
      "Value": "ExpectedPremiumArray",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "return ${ExpectedPremiumArray}.length",
      "Value": "ExpectedPremiumCount",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "${!COL45}",
      "Value": "ExpectedPremiumQty",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "[${CaseID}] [${SKU}] Starting Test Case",
      "Value": "blue",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "${!COL15}",
      "Value": "Email",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "${!COL16}",
      "Value": "Password",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "pause // 100000",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "##########################",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "##########################",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "##########################",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "##########################",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "**Login EPP**",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "true",
      "Value": "!statusOK",
      "Description": ""
    },
    {
      "Command": "verifyElementPresent",
      "Target": "xpath=//*[@data-automation-id=\"epp-login-button\"]",
      "Value": "!statusOK",
      "Description": ""
    },
    {
      "Command": "if_v2",
      "Target": "${!statusOK}==true",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "click",
      "Target": "xpath=//*[@data-automation-id=\"epp-login-button\"]",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "type",
      "Target": "id=iptLgnPlnID",
      "Value": "cptqaer@gmail.com",
      "Description": ""
    },
    {
      "Command": "click",
      "Target": "id=signInButton",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "type",
      "Target": "id=iptLgnPlnPD",
      "Value": "!Cheil2024",
      "Description": ""
    },
    {
      "Command": "click",
      "Target": "id=signInButton",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "##########################",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "##########################",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "##########################",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "##########################",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "**Screencap Buy Page**",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "captureEntirePageScreenshot // CE-${!csvReadLineNumber}-${CaseID}-BuyPage-${SKUwithoutSlash}-${DateTimeNow}.png",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "##########################",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "##########################",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "##########################",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "##########################",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "**Verify SKU**",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "true",
      "Value": "!statusOK",
      "Description": ""
    },
    {
      "Command": "verifyText",
      "Target": "xpath=//*[@class=\"pd-info__sku-code\"]",
      "Value": "${SKU}",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "${SKU}",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "${ProductName}",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "**Verify if OOS (Blocked)**",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "verifyElementPresent // xpath=//a[@onclick=\"bc_cta.addToCart(); return false;\"]",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "verifyElementPresent",
      "Target": "xpath=//*[contains(@class, \"js-buy-now\")]",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "if_v2",
      "Target": "${!statusOK}==true",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "true",
      "Value": "!statusOK",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "**Check SKU Price**",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "storeText",
      "Target": "xpath=//*[@class=\"cost-box__price-now\"]",
      "Value": "SKUPrice",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "return Number(${SKUPrice}.replace(/[^0-9.-]+/g,\"\"));",
      "Value": "SKUPrice",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "SKU Price",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "${SKUPrice}",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "if_v2",
      "Target": "${ExpectedSKUPrice}==${SKUPrice}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "Passed",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "else",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "Failed",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "Failed",
      "Value": "TestResult",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "[${SKU}] SKU Price: Failed - Expected ${ExpectedSKUPrice} / Actual ${SKUPrice}",
      "Value": "red",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "**Trade-Up**",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "if_v2",
      "Target": "${TradeUp}==\"Yes\"",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "click // xpath=//*[@an-la=\"trade-up:yes\"]",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "run // AddTradeUp",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "else",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "click",
      "Target": "xpath=//*[@an-la=\"trade-up:no\"]",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "**Add to Cart**",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "click",
      "Target": "xpath=//*[@class='pd-buying-price__cta']/a",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "**Verify - Add On**",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "pause",
      "Target": "1000",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "true",
      "Value": "!statusOK",
      "Description": ""
    },
    {
      "Command": "verifyElementPresent",
      "Target": "xpath=//*[@id=\"primaryInfoGoCartAddOn\"]",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "if_v2",
      "Target": "${!statusOK}==true",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "clickAndWait",
      "Target": "xpath=//*[@id=\"primaryInfoGoCartAddOn\"]",
      "Value": "500",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "**(Galaxy Credit)**",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "times",
      "Target": "3",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "else",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "**Product is OOS (Blocked)**",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "times",
      "Target": "53",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "OOS (Blocked)",
      "Value": "TestResult",
      "Description": ""
    },
    {
      "Command": "captureScreenshot",
      "Target": "CE-${!csvReadLineNumber}-${CaseID}-BuyPage-${SKUwithoutSlash}-${DateTimeNow}-OOS.png",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "##########################",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "##########################",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "##########################",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "##########################",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "**Skip to end if OOS (Blocked)**",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "if_v2",
      "Target": "${TestResult}!=\"OOS (Blocked)\"",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "**Trade-Up**",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "if_v2",
      "Target": "${TradeUp}==\"Yes\"",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "click",
      "Target": "xpath=//*[@data-an-la=\"add service:trade-in\"]",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "run",
      "Target": "AddTradeUpInCart",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "else",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "click",
      "Target": "xpath=//*[@an-la=\"trade-up:no\"]",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "**Check Cart Total**",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "storeText",
      "Target": "xpath=//*[contains(@class, \"total-right-value\")]",
      "Value": "CartTotal",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "return Number(${CartTotal}.replace(/[^0-9.-]+/g,\"\"));",
      "Value": "CartTotal",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "**Check SKU Price in Cart**",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "true",
      "Value": "!statusOK",
      "Description": ""
    },
    {
      "Command": "verifyElementPresent",
      "Target": "xpath=//*[@data-modelcode=\"${SKU}\"]//div[@class=\"item-price\"]",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "if_v2",
      "Target": "${!statusOK}==true",
      "Value": "!statusOK",
      "Description": ""
    },
    {
      "Command": "storeText",
      "Target": "xpath=//*[@data-modelcode=\"${SKU}\"]//div[@class=\"item-price\"]",
      "Value": "SKUPriceCart",
      "Description": ""
    },
    {
      "Command": "else",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "storeText",
      "Target": "xpath=//*[@data-omni-variant=\"${SKU}\"]//div[@class=\"item-price\"]",
      "Value": "SKUPriceCart",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "return ${SKUPriceCart}.split(/\\r?\\n/)[0].trim();",
      "Value": "SKUPriceCart",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "SKUPriceCart = ${SKUPriceCart}",
      "Value": "blue",
      "Description": ""
    },
    {
      "Command": "if_v2",
      "Target": "${SKUPriceCart}.includes(\"節省\")==true",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "return ${SKUPriceCart}.split(\"節省\")[0].trim();",
      "Value": "SKUPriceCart",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "SKUPriceCart = ${SKUPriceCart}",
      "Value": "blue",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "return Number(${SKUPriceCart}.replace(/[^0-9.-]+/g,\"\"));",
      "Value": "SKUPriceCart",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "SKU Price in Cart",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "${SKUPrice}",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "if_v2",
      "Target": "${ExpectedSKUPriceCart}==${SKUPriceCart}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "Passed",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "else",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "Failed",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "Failed",
      "Value": "TestResult",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "[${SKU}] SKU Price in Cart: Failed - Expected ${ExpectedSKUPriceCart} / Actual ${SKUPriceCart}",
      "Value": "red",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "**Check Trade-Up**",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "Trade-Up Discount",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "if_v2",
      "Target": "${TradeUp}==\"Yes\"",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "true",
      "Value": "!statusOK",
      "Description": ""
    },
    {
      "Command": "verifyElementNotPresent",
      "Target": "xpath=//*[@class=\"quantity-error\"]",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "if_v2",
      "Target": "${!statusOK}==true",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "storeText",
      "Target": "xpath=//*[@data-modelcode=\"${SKU}\"]//div[@class=\"item-discount-price\"]",
      "Value": "TradeUpDiscount",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "return ${TradeUpDiscount}.split(\"- HK$\")[1].trim();",
      "Value": "TradeUpDiscount",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "return Number(${TradeUpDiscount}.split(\".00\")[0].trim().replace(/[^0-9.-]+/g,\"\"));",
      "Value": "TradeUpDiscount",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "${TradeUpDiscount}",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "if_v2",
      "Target": "${ExpectedTradeUpDiscount}==${TradeUpDiscount}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "Passed",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "else",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "Failed",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "Failed",
      "Value": "TestResult",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "[${SKU}] Trade-Up Discount: Failed - Expected ${ExpectedTradeUpDiscount} / Actual ${TradeUpDiscount}",
      "Value": "red",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "else",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "times",
      "Target": "2",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "**Check SC+**",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "SC Plus Price",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "if_v2",
      "Target": "${SCPlus}==\"Yes\"",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "true",
      "Value": "!statusOK",
      "Description": ""
    },
    {
      "Command": "verifyElementNotPresent",
      "Target": "xpath=//*[@class=\"quantity-error\"]",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "if_v2",
      "Target": "${!statusOK}==true",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "storeText",
      "Target": "xpath=//*[@id=\"as-smc\"]//span[@class=\"price\"]/p",
      "Value": "SCPlusPrice",
      "Description": ""
    },
    {
      "Command": "if_v2",
      "Target": "${SCPlusPrice}==\"免費\"",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "0",
      "Value": "SCPlusPrice",
      "Description": ""
    },
    {
      "Command": "else",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "return ${SCPlusPrice}.split(\"HK$\")[1].trim();",
      "Value": "SCPlusPrice",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "return ${SCPlusPrice}.split(\".00\")[0].trim();",
      "Value": "SCPlusPrice",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "return Number(${SCPlusPrice}.replace(/[^0-9.-]+/g,\"\"));",
      "Value": "SCPlusPrice",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "${SCPlusPrice}",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "if_v2",
      "Target": "${ExpectedSCPlusPrice}==${SCPlusPrice}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "Passed",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "else",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "Failed",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "Failed",
      "Value": "TestResult",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "[${SKU}] SC Plus Price: Failed - Expected ${ExpectedSCPlusPrice} / Actual ${SCPlusPrice}",
      "Value": "red",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "else",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "times",
      "Target": "2",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "**Count Premiums**",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "storeXpathCount",
      "Target": "xpath=//li[contains(@class,\"cart-row\")]",
      "Value": "ItemCount",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "return Number(${ItemCount})-1",
      "Value": "PremiumCount",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "Premium Count",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "${PremiumCount}",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "if_v2",
      "Target": "${ExpectedPremiumCount}==${PremiumCount}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "Passed",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "-",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "elseif",
      "Target": "${PremiumCount}>${ExpectedPremiumCount}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "Failed",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "More - Expected ${ExpectedPremiumCount} / Actual ${PremiumCount}",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "Failed",
      "Value": "TestResult",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "${SKU} - Premium Count: Failed - more - Expected ${ExpectedPremiumCount} / Actual ${PremiumCount}",
      "Value": "red",
      "Description": ""
    },
    {
      "Command": "elseif",
      "Target": "${PremiumCount}<${ExpectedPremiumCount}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "Failed",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "Less - Expected ${ExpectedPremiumCount} / Actual ${PremiumCount}",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "Failed",
      "Value": "TestResult",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "[${SKU}] Premium Count: Failed - less - Expected ${ExpectedPremiumCount} / Actual ${PremiumCount}",
      "Value": "red",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "**Check Premiums**",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "Items in Cart",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "times",
      "Target": "${ItemCount}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "storeText",
      "Target": "xpath=//li[contains(@class,\"cart-row\")][${!times}]//div[@data-automation-id=\"cart-item-sku\"]",
      "Value": "ThisSKU",
      "Description": ""
    },
    {
      "Command": "storeAttribute",
      "Target": "xpath=//li[contains(@class,\"cart-row\")][${!times}]//input[@data-automation-id=\"txt-qty\"]@value",
      "Value": "ThisQty",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "echo // Item ${!times}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "${ThisSKU}",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "${ThisQty}",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "${ThisSKU}: ${ThisQty}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "echo // Check if ${ThisSKU} is Expected",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "",
      "Value": "CheckingPremiumSKU",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "return false",
      "Value": "VerifyThisSKU",
      "Description": ""
    },
    {
      "Command": "forEach",
      "Target": "ExpectedPremiumArray",
      "Value": "CheckingPremiumSKU",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "echo // try ${CheckingPremiumSKU}",
      "Value": "blue",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "echo // against ${ThisSKU}",
      "Value": "blue",
      "Description": ""
    },
    {
      "Command": "if_v2",
      "Target": "${CheckingPremiumSKU}==${ThisSKU}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "return true",
      "Value": "VerifyThisSKU",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "if_v2",
      "Target": "${SKU}==${ThisSKU}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "return true",
      "Value": "VerifyThisSKU",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "if_v2",
      "Target": "${VerifyThisSKU}==true",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "${ThisSKU} is Expected",
      "Value": "green",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "Passed",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "else",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "${ThisSKU} is Not Expected",
      "Value": "red",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "Failed",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "Failed",
      "Value": "TestResult",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "",
      "Value": "ThisSKU",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "return 3*(10-${PremiumCount})",
      "Value": "EmptyPremiumCount",
      "Description": ""
    },
    {
      "Command": "times",
      "Target": "${EmptyPremiumCount}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "**Screencap Cart Page**",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "captureEntirePageScreenshot",
      "Target": "CE-${!csvReadLineNumber}-${CaseID}-CartPage-${SKUwithoutSlash}-${DateTimeNow}-${TestResult}.png",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "**Clear Cart**",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "click",
      "Target": "xpath=//button[@data-variant-sku=\"${SKU}\"]//*[@class=\"icon-remove no-rtl\"]",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "true",
      "Value": "!statusOK",
      "Description": ""
    },
    {
      "Command": "pause",
      "Target": "300",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "verifyElementNotPresent",
      "Target": "xpath=//div[contains(@class,\"cart-empty-container\")]",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "if_v2",
      "Target": "${!statusOK}==true",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "storeXpathCount",
      "Target": "xpath=//*[@class=\"cart-item-top cart-item-top-lg\"]//div[@class=\"cart-top-actions\"]//button[@data-automation-id=\"removeEntry\"]",
      "Value": "RemoveIconCount",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "\"RemoveIconCount\" = ${RemoveIconCount}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "times",
      "Target": "${RemoveIconCount}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "pause",
      "Target": "400",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "click",
      "Target": "xpath=//*[@class=\"cart-item-top cart-item-top-lg\"]//div[@class=\"cart-top-actions\"]//button[@data-automation-id=\"removeEntry\"]",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "**Log Final Test Results**",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "if_v2",
      "Target": "${TestResult}==\"Passed\"",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "[${!csvReadLineNumber}] [${CaseID}] [${SKU}] ${ProductName} == ${TestResult}",
      "Value": "green",
      "Description": ""
    },
    {
      "Command": "elseif",
      "Target": "${TestResult}==\"Failed\"",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "[${!csvReadLineNumber}] [${CaseID}] [${SKU}] ${ProductName} == ${TestResult}",
      "Value": "red",
      "Description": ""
    },
    {
      "Command": "elseif",
      "Target": "${TestResult}==\"OOS (Blocked)\"",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "[${!csvReadLineNumber}] [${CaseID}] [${SKU}] ${ProductName} == ${TestResult}",
      "Value": "orange",
      "Description": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "${TestResult}",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "${!Runtime}",
      "Value": "EndTime",
      "Description": ""
    },
    {
      "Command": "executeScript",
      "Target": "return Number(${EndTime}.replace(/[^0-9.-]+/g,\"\"))-Number(${StartTime}.replace(/[^0-9.-]+/g,\"\"));",
      "Value": "TestDuration",
      "Description": ""
    },
    {
      "Command": "store",
      "Target": "${TestDuration}",
      "Value": "!csvLine",
      "Description": ""
    },
    {
      "Command": "echo",
      "Target": "Test Duration: ${TestDuration}",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "csvSave",
      "Target": "_Results-CE-${DateToday}.csv",
      "Value": "",
      "Description": ""
    },
    {
      "Command": "comment",
      "Target": "**End of TestCaseMX**",
      "Value": "",
      "Description": ""
    }
  ]
}